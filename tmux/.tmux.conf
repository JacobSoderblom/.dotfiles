##### Prefix, reload, basics ####################################################
set -g prefix C-s
unbind C-b
bind r source-file ~/.tmux.conf \; display-message "tmux config reloaded"

set -g mouse on
set -g history-limit 100000
set -g status-interval 2
set -g focus-events on
set -g escape-time 0

##### Numbering (windows & panes start at 1) ###################################
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on

##### Colors / Truecolor / Italics #############################################
# Preferred (modern) – ensure 'tmux-256color' terminfo exists locally & remotely
set -g default-terminal "tmux-256color"
set -as terminal-overrides ',*:Tc'
set -as terminal-overrides ',xterm-256color:RGB'
# If you hit remote compat issues, try:
# set -g default-terminal "screen-256color"

##### Clipboard integration #####################################################
set -g set-clipboard on  # cooperate with system clipboard (pbcopy/xclip/wl-copy via tmux-yank)

##### Pane resizing (arrow keys with prefix; fast Alt-arrows without prefix) ####
# Your original big steps with prefix
unbind Right; bind Right resize-pane -R 8
unbind Left;  bind Left  resize-pane -L 8
unbind Up;    bind Up    resize-pane -U 4
unbind Down;  bind Down  resize-pane -D 4

# Prefix-less quick resize (hold Alt + arrows)
bind -n M-Left  resize-pane -L 5
bind -n M-Right resize-pane -R 5
bind -n M-Up    resize-pane -U 3
bind -n M-Down  resize-pane -D 3

##### Path-aware splits & windows ##############################################
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

##### Vim-like navigation between panes ########################################
setw -g mode-keys vi
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

##### Copy-mode (VI) niceties ###################################################
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi V send -X select-line
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi r send -X rectangle-toggle

##### QoL: jump anywhere / synchronize / last pane #############################
bind Space choose-tree -Zw
bind S set-window-option synchronize-panes \; display 'sync-panes: #{?pane_synchronized,on,off}'
bind Tab last-pane

##### Status bar position & GitHub theme ###################################
set-option -g status-position top

# GitHub Dark High Contrast colors
set -g status-style "bg=#0a0c10,fg=#f0f6fc"
set -g message-style "bg=#79c0ff,fg=#0a0c10"
set -g pane-border-style "fg=#484f58"
set -g pane-active-border-style "fg=#79c0ff"
set -g display-panes-colour "#484f58"
set -g display-panes-active-colour "#79c0ff"
set -g message-command-style "bg=#79c0ff,fg=#0a0c10"
set -g mode-style "bg=#79c0ff,fg=#0a0c10"
set -g window-status-current-style "bg=#161b22,fg=#79c0ff"
set -g window-status-current-format " #I:#W "
set -g window-status-style "fg=#f0f6fc,bg=#161b22"
set -g window-status-format " #I:#W "

##### Session handling ##############################################
# Safe: prompt before killing the current session
bind x confirm-before -p "Kill session #S? (y/n)" kill-session

# Force: kill the current session immediately
bind X kill-session
# Session kill menu (picker)
# prefix + K  → shows a list of sessions; choose one, confirm, then kill it
bind K choose-tree -Zs "confirm-before -p \"Kill session '%%'? (y/n)\" \"kill-session -t '%%'\""

# Optional: quick attach menu if you pick the wrong thing :)
# prefix + A  → choose a session to attach/switch to
bind A choose-tree -Zs "switch-client -t '%%'"

set -g status-left "#[fg=#79c0ff,bg=#0a0c10]#[fg=#79c0ff,bg=#161b22] #S #[fg=#161b22,bg=#0a0c10]"
set -g status-right "#[fg=#79c0ff,bg=#0a0c10]#[fg=#79c0ff,bg=#161b22] %H:%M #[fg=#161b22,bg=#0a0c10]"

# If glyph spacing looks off with your font, you can try:
# set -g status-justify centre

##### Plugins ###################################################################
# Core plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'

# Your existing extras
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'jimeh/tmuxifier'

##### Auto-install TPM if missing (first run convenience) ######################
if-shell '[ ! -d ~/.tmux/plugins/tpm ]' \
  'run -b "git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm"'

# Initialize TMUX Plugin Manager (keep this line at the very bottom)
run '~/.tmux/plugins/tpm/tpm'
